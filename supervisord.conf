[unix_http_server]
file=/tmp/supervisor.sock   ; path to your socket file

[supervisord]
logfile=/var/log/supervisord.log ; main log file; default $CWD/supervisord.log
logfile_maxbytes=50MB        ; max main logfile bytes b4 rotation; default 50MB
logfile_backups=10           ; # of main logfile backups; 0 means none, default 10
loglevel=info                ; log level; default info; others: debug,warn,trace
pidfile=/tmp/supervisord.pid ; supervisord pidfile; default supervisord.pid
nodaemon=true                ; start in foreground if true; default false
minfds=1024                  ; min. avail startup file descriptors; default 1024
minprocs=200                 ; min. avail process descriptors;default 200
user=root                    ; setuid to this UNIX account at startup; recommended if running as root

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix:///tmp/supervisor.sock ; use a unix:// URL  for a unix socket

; --- Define Programs to Run --- 

[program:phase1_ui]
command=python phase1_ui.py
directory=/code
autostart=true
autorestart=true
stdout_logfile=/var/log/phase1_ui.log
stderr_logfile=/var/log/phase1_ui_err.log
stdout_logfile_maxbytes=10MB
stderr_logfile_maxbytes=10MB

[program:phase2_backend]
; Run uvicorn directly, listening on all interfaces inside the container
command=uvicorn app.main:app --host 0.0.0.0 --port 8000
directory=/code
autostart=true
autorestart=true
stdout_logfile=/var/log/phase2_backend.log
stderr_logfile=/var/log/phase2_backend_err.log
stdout_logfile_maxbytes=10MB
stderr_logfile_maxbytes=10MB

[program:phase2_frontend]
command=python frontend/ui.py
directory=/code
autostart=true
autorestart=true
stdout_logfile=/var/log/phase2_frontend.log
stderr_logfile=/var/log/phase2_frontend_err.log
stdout_logfile_maxbytes=10MB
stderr_logfile_maxbytes=10MB 